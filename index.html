<!DOCTYPE html>
<html>
<head>
  <title>Poll Form</title>
  <style>
    /* Your existing styles */
  </style>
</head>
<body>
  <!-- Your existing form HTML -->
  
  <script>
    // Handle the message from the iframe
    window.addEventListener('message', function(event) {
      if (event.data === 'formSubmissionSuccess') {
        document.getElementById('pollForm').style.display = 'none';
        document.getElementById('success-message').style.display = 'block';
      } else if (event.data === 'formSubmissionError') {
        document.getElementById('error-text').textContent = 'Submission failed. Please try again.';
        document.getElementById('error-message').style.display = 'block';
      }
    });

    document.getElementById('pollForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const form = e.target;
      
      // Create a hidden iframe
      const iframe = document.createElement('iframe');
      iframe.name = 'hiddenFrame';
      iframe.style.display = 'none';
      
      // Create a form for submission
      const hiddenForm = document.createElement('form');
      hiddenForm.action = 'https://script.google.com/macros/s/AKfycby1fPiJmK7nwfE9gn_thLJe5LP9IEjnQDfH9zWcr8rrGRf2m1H6tcOigDidZpUj5P8H/exec';
      hiddenForm.method = 'POST';
      hiddenForm.target = 'hiddenFrame';
      
      // Add form data
      const inputs = [
        { name: 'question1', value: form.question1.value },
        { name: 'question2', value: form.question2.value }
      ];
      
      inputs.forEach(input => {
        const element = document.createElement('input');
        element.type = 'hidden';
        element.name = input.name;
        element.value = input.value;
        hiddenForm.appendChild(element);
      });
      
      document.body.appendChild(iframe);
      document.body.appendChild(hiddenForm);
      hiddenForm.submit();
      
      // Clean up after submission
      setTimeout(() => {
        document.body.removeChild(iframe);
        document.body.removeChild(hiddenForm);
      }, 3000);
    });
  </script>
</body>
</html>
