<!DOCTYPE html>
<html>
<head>
  <title>Working Poll Form</title>
  <style>
    /* Your existing styles */
  </style>
</head>
<body>
  <!-- Your existing form HTML -->
  
  <script>
    document.getElementById('pollForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const form = e.target;
      const formData = new FormData();
      formData.append('question1', form.question1.value);
      formData.append('question2', form.question2.value);
      
      // Use a proxy if needed (see below)
      const scriptUrl = 'https://script.google.com/macros/s/AKfycbw5mV8zii8Pj_eW7em9hUUkUmRMRJQZ9t6Iw-CVd8pAOc4-_FIB-Qye9YyEclG4uunt/exec';
      
      // Create a hidden iframe to submit the form
      const iframe = document.createElement('iframe');
      iframe.name = 'hiddenFrame';
      iframe.style.display = 'none';
      
      // Create a form to submit to the iframe
      const hiddenForm = document.createElement('form');
      hiddenForm.action = scriptUrl;
      hiddenForm.method = 'POST';
      hiddenForm.target = 'hiddenFrame';
      
      // Add form data
      const input1 = document.createElement('input');
      input1.type = 'hidden';
      input1.name = 'question1';
      input1.value = form.question1.value;
      hiddenForm.appendChild(input1);
      
      const input2 = document.createElement('input');
      input2.type = 'hidden';
      input2.name = 'question2';
      input2.value = form.question2.value;
      hiddenForm.appendChild(input2);
      
      document.body.appendChild(iframe);
      document.body.appendChild(hiddenForm);
      hiddenForm.submit();
      
      // Show success message (we can't get response due to CORS)
      document.getElementById('pollForm').style.display = 'none';
      document.getElementById('success-message').style.display = 'block';
      
      // Clean up after a delay
      setTimeout(() => {
        document.body.removeChild(iframe);
        document.body.removeChild(hiddenForm);
      }, 5000);
    });
  </script>
</body>
</html>
